{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\namas\\\\Downloads\\\\lifeInNumbers4-20211203T231224Z-001\\\\lifeInNumbers4\\\\src\\\\components\\\\bareminimum.js\";\nimport { Redirect } from \"react-router-dom\";\nimport { AuthContext } from \"./Auth\";\nimport firebaseConfig from \"../firebase\";\nimport React, { useState, useRef, useEffect, useContext } from \"react\";\nimport Form from \"./Form\";\nimport FilterButton from \"./FilterButton\";\nimport Todo from \"./Todo\";\nimport { nanoid } from 'nanoid';\nimport { getDatabase, ref, onValue, set } from 'firebase/database';\n/*const BAREMINIMUM = [\r\n  { id: \"todo-0\", name: \"Attend All Classes\", completed: true },\r\n  { id: \"todo-1\", name: \"3hrs of Assignments\", completed: false },\r\n  { id: \"todo-2\", name: \"1hr of Job Search Efforts\", completed: false }\r\n];*/\n\nconst BAREMINIMUM = [];\n\nfunction usePrevious(value) {\n  const ref = useRef();\n  useEffect(() => {\n    ref.current = value;\n  });\n  return ref.current;\n}\n\nconst FILTER_MAP = {\n  All: () => true,\n  Active: task => !task.completed,\n  Completed: task => task.completed\n};\nconst FILTER_NAMES = Object.keys(FILTER_MAP);\n\nconst Bareminimum = () => {\n  const [date, setDate] = useState(new Date());\n  const [tasks, setTasks] = useState(BAREMINIMUM);\n  const [filter, setFilter] = useState('All');\n  const [count, setCount] = useState(0);\n\n  function fetchDataFromFirebase() {\n    const db = getDatabase();\n    var user = firebaseConfig.auth().currentUser;\n    var d = new Date();\n    var datestring = d.getDate() + \"-\" + (d.getMonth() + 1) + \"-\" + d.getFullYear();\n    const reference = ref(db, 'users/' + user.uid + '/' + datestring + '/bareminimum/');\n    let todoslist = [];\n    let todomap = {};\n    var i = 0;\n    onValue(reference, snapshot => {\n      snapshot.forEach(snapshot1 => {\n        var id = snapshot1.val().todoid;\n        const name = snapshot1.val().name;\n        const completed = snapshot1.val().completed;\n        var todoid = String(id);\n\n        if (todoid.includes(\"todo\") === true) {\n          todomap = {\n            id: id,\n            name: name,\n            completed: completed\n          };\n          todoslist.push(todomap);\n        }\n      });\n      setTasks(todoslist);\n    });\n  }\n\n  function CalculatePersonalScore() {\n    const db = getDatabase();\n    var user = firebaseConfig.auth().currentUser;\n    var d = new Date();\n    var datestring = d.getDate() + \"-\" + (d.getMonth() + 1) + \"-\" + d.getFullYear();\n    const reference = ref(db, 'users/' + user.uid + '/' + datestring + '/bareminimum/');\n    let todoslist = [];\n    let todomap = {};\n    var completedTasks = 0;\n    var totalTaskCount = 0;\n    onValue(reference, snapshot => {\n      snapshot.forEach(snapshot1 => {\n        var id = snapshot1.val().todoid;\n        var todoid = String(id);\n        const completed = snapshot1.val().completed;\n\n        if (todoid.includes(\"todo\") === true) {\n          if (completed === true) {\n            completedTasks++;\n          }\n\n          totalTaskCount++;\n        }\n      });\n    });\n    var per = 0;\n    var percentage = 0;\n\n    if (totalTaskCount > 0) {\n      per = completedTasks / totalTaskCount * 100;\n      percentage = Math.floor(per);\n    }\n\n    setCount(percentage);\n    const reference1 = ref(db, 'users/' + user.uid + '/' + datestring + '/score/bareminimumpercentage/');\n    set(reference1, {\n      percentage: percentage\n    });\n  }\n\n  function toggleTaskCompleted(id) {\n    const updatedTasks = tasks.map(task => {\n      // if this task has the same ID as the edited task\n      if (id === task.id) {\n        // use object spread to make a new obkect\n        // whose `completed` prop has been inverted\n        const db = getDatabase();\n        var user = firebaseConfig.auth().currentUser;\n        var d = new Date();\n        var datestring = d.getDate() + \"-\" + (d.getMonth() + 1) + \"-\" + d.getFullYear();\n        const reference = ref(db, 'users/' + user.uid + '/' + datestring + '/bareminimum/' + id);\n        set(reference, {\n          todoid: task.id,\n          name: task.name,\n          completed: !task.completed\n        });\n        return { ...task,\n          completed: !task.completed\n        };\n      }\n\n      return task;\n    }); //setTasks(updatedTasks);\n\n    fetchDataFromFirebase();\n    CalculatePersonalScore();\n  }\n\n  function deleteTask(id) {\n    const remainingTasks = tasks.filter(task => id !== task.id); //setTasks(remainingTasks);\n\n    const db = getDatabase();\n    var user = firebaseConfig.auth().currentUser;\n    var d = new Date();\n    var datestring = d.getDate() + \"-\" + (d.getMonth() + 1) + \"-\" + d.getFullYear();\n    const reference = ref(db, 'users/' + user.uid + '/' + datestring + '/bareminimum/' + id);\n    set(reference, {\n      id: null\n    });\n    fetchDataFromFirebase();\n  }\n\n  function editTask(id, newName) {\n    const editedTaskList = tasks.map(task => {\n      // if this task has the same ID as the edited task\n      if (id === task.id) {\n        //\n        const db = getDatabase();\n        var user = firebaseConfig.auth().currentUser;\n        var d = new Date();\n        var datestring = d.getDate() + \"-\" + (d.getMonth() + 1) + \"-\" + d.getFullYear();\n        const reference = ref(db, 'users/' + user.uid + '/' + datestring + '/bareminimum/' + task.id);\n        set(reference, {\n          todoid: task.id,\n          name: newName,\n          completed: task.completed\n        });\n        return { ...task,\n          name: newName\n        };\n      }\n\n      return task;\n    }); //setTasks(editedTaskList);\n\n    fetchDataFromFirebase();\n  }\n\n  const taskList = tasks.filter(FILTER_MAP[filter]).map(task => /*#__PURE__*/React.createElement(Todo, {\n    id: task.id,\n    name: task.name,\n    completed: task.completed,\n    key: task.id,\n    toggleTaskCompleted: toggleTaskCompleted,\n    deleteTask: deleteTask,\n    editTask: editTask,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 178,\n      columnNumber: 3\n    }\n  }));\n  const filterList = FILTER_NAMES.map(name => /*#__PURE__*/React.createElement(FilterButton, {\n    key: name,\n    name: name,\n    isPressed: name === filter,\n    setFilter: setFilter,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 190,\n      columnNumber: 3\n    }\n  }));\n\n  function addTask(name) {\n    const newTask = {\n      id: \"todo-\" + nanoid(),\n      name: name,\n      completed: false\n    }; //setTasks([...tasks, newTask]);\n    //Database related\n\n    const db = getDatabase();\n    var user = firebaseConfig.auth().currentUser;\n    var d = new Date();\n    var datestring = d.getDate() + \"-\" + (d.getMonth() + 1) + \"-\" + d.getFullYear();\n    const reference = ref(db, 'users/' + user.uid + '/' + datestring + '/bareminimum/' + newTask.id);\n    set(reference, {\n      todoid: newTask.id,\n      name: newTask.name,\n      completed: newTask.completed\n    });\n    fetchDataFromFirebase();\n  }\n\n  const tasksNoun = taskList.length !== 1 ? 'tasks' : 'task';\n  const headingText = `${taskList.length} ${tasksNoun} remaining`;\n  const listHeadingRef = useRef(null);\n  const prevTaskLength = usePrevious(tasks.length);\n  useEffect(() => {\n    fetchDataFromFirebase();\n    CalculatePersonalScore();\n\n    if (tasks.length - prevTaskLength === -1) {\n      listHeadingRef.current.focus();\n    }\n  }, [tasks.length, prevTaskLength]);\n  const {\n    currentUser\n  } = useContext(AuthContext);\n\n  if (!currentUser) {\n    return /*#__PURE__*/React.createElement(Redirect, {\n      to: \"/\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 233,\n        columnNumber: 10\n      }\n    });\n  }\n\n  let Progress = props => {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"Progress\",\n      \"data-value\": props.value,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 238,\n        columnNumber: 5\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"Progress-Bar\",\n      style: {\n        width: `${props.value}%`,\n        backgroundSize: `${100 * 100 / props.value}% 100%`\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 239,\n        columnNumber: 7\n      }\n    }));\n  };\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 251,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"todoapp stack-large\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 252,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"h1\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 253,\n      columnNumber: 9\n    }\n  }, \"Bare Minimum\"), /*#__PURE__*/React.createElement(Progress, {\n    value: count,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 254,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(Form, {\n    addTask: addTask,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 255,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"filters btn-group stack-exception\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 256,\n      columnNumber: 7\n    }\n  }, filterList), /*#__PURE__*/React.createElement(\"h2\", {\n    id: \"list-heading\",\n    tabIndex: \"-1\",\n    ref: listHeadingRef,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 259,\n      columnNumber: 7\n    }\n  }, headingText), /*#__PURE__*/React.createElement(\"ul\", {\n    role: \"list\",\n    className: \"todo-list stack-large stack-exception\",\n    \"aria-labelledby\": \"list-heading\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 262,\n      columnNumber: 7\n    }\n  }, taskList)));\n};\n\nexport default Bareminimum;","map":{"version":3,"sources":["C:/Users/namas/Downloads/lifeInNumbers4-20211203T231224Z-001/lifeInNumbers4/src/components/bareminimum.js"],"names":["Redirect","AuthContext","firebaseConfig","React","useState","useRef","useEffect","useContext","Form","FilterButton","Todo","nanoid","getDatabase","ref","onValue","set","BAREMINIMUM","usePrevious","value","current","FILTER_MAP","All","Active","task","completed","Completed","FILTER_NAMES","Object","keys","Bareminimum","date","setDate","Date","tasks","setTasks","filter","setFilter","count","setCount","fetchDataFromFirebase","db","user","auth","currentUser","d","datestring","getDate","getMonth","getFullYear","reference","uid","todoslist","todomap","i","snapshot","forEach","snapshot1","id","val","todoid","name","String","includes","push","CalculatePersonalScore","completedTasks","totalTaskCount","per","percentage","Math","floor","reference1","toggleTaskCompleted","updatedTasks","map","deleteTask","remainingTasks","editTask","newName","editedTaskList","taskList","filterList","addTask","newTask","tasksNoun","length","headingText","listHeadingRef","prevTaskLength","focus","Progress","props","width","backgroundSize"],"mappings":"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","sourcesContent":["import { Redirect } from \"react-router-dom\";\r\nimport { AuthContext } from \"./Auth\";\r\nimport firebaseConfig from \"../firebase\";\r\nimport React, { useState, useRef, useEffect, useContext } from \"react\";\r\nimport Form from \"./Form\";\r\nimport FilterButton from \"./FilterButton\";\r\nimport Todo from \"./Todo\";\r\nimport { nanoid } from 'nanoid';\r\nimport { getDatabase, ref, onValue, set } from 'firebase/database';\r\n\r\n\r\n\r\n/*const BAREMINIMUM = [\r\n  { id: \"todo-0\", name: \"Attend All Classes\", completed: true },\r\n  { id: \"todo-1\", name: \"3hrs of Assignments\", completed: false },\r\n  { id: \"todo-2\", name: \"1hr of Job Search Efforts\", completed: false }\r\n];*/\r\n\r\nconst BAREMINIMUM = [];\r\n\r\nfunction usePrevious(value) {\r\n  const ref = useRef();\r\n  useEffect(() => {\r\n    ref.current = value;\r\n  });\r\n  return ref.current;\r\n}\r\n\r\nconst FILTER_MAP = {\r\n  All: () => true,\r\n  Active: task => !task.completed,\r\n  Completed: task => task.completed\r\n};\r\n\r\nconst FILTER_NAMES = Object.keys(FILTER_MAP);\r\n\r\nconst Bareminimum = () =>  {\r\n\r\nconst [date, setDate] = useState(new Date());\r\n\r\nconst [tasks, setTasks] = useState(BAREMINIMUM);\r\nconst [filter, setFilter] = useState('All');\r\nconst [count, setCount] = useState(0);\r\n\r\nfunction fetchDataFromFirebase() {\r\n  const db = getDatabase();\r\n  var user = firebaseConfig.auth().currentUser\r\n  var d = new Date();\r\n  var datestring = d.getDate()  + \"-\" + (d.getMonth()+1) + \"-\" + d.getFullYear();\r\n  const reference = ref(db, 'users/' + user.uid +'/'+ datestring+ '/bareminimum/');\r\n  let todoslist = [];\r\n  let todomap = {};\r\n  var i = 0;\r\n  onValue(reference, (snapshot) => {\r\n    snapshot.forEach(snapshot1 => {\r\n      var id = snapshot1.val().todoid\r\n      const name = snapshot1.val().name\r\n      const completed = snapshot1.val().completed\r\n      var todoid = String(id)\r\n      if (todoid.includes(\"todo\") === true) {\r\n        todomap = {\r\n          id: id,\r\n          name: name,\r\n          completed: completed\r\n        };\r\n        todoslist.push(todomap)\r\n      }\r\n    });   \r\n    setTasks(todoslist)\r\n  });\r\n}\r\n\r\n\r\nfunction CalculatePersonalScore() {\r\n  const db = getDatabase();\r\n  var user = firebaseConfig.auth().currentUser\r\n  var d = new Date();\r\n  var datestring = d.getDate()  + \"-\" + (d.getMonth()+1) + \"-\" + d.getFullYear();\r\n  const reference = ref(db, 'users/' + user.uid +'/'+ datestring+ '/bareminimum/');\r\n  let todoslist = [];\r\n  let todomap = {};\r\n  var completedTasks = 0;\r\n  var totalTaskCount = 0 ;\r\n  onValue(reference, (snapshot) => {\r\n    snapshot.forEach(snapshot1 => {\r\n      var id = snapshot1.val().todoid\r\n      var todoid = String(id)\r\n    const completed = snapshot1.val().completed\r\n    if (todoid.includes(\"todo\") === true) {\r\n      if (completed === true) {\r\n    \r\n        completedTasks++\r\n      }\r\n      totalTaskCount++\r\n    }\r\n    });   \r\n  });\r\n  var per = 0\r\n  var percentage = 0\r\n  if (totalTaskCount > 0) {\r\n    per = (completedTasks/totalTaskCount) * 100\r\n    percentage = Math.floor(per)\r\n  }\r\n  setCount(percentage)\r\n  const reference1 = ref(db, 'users/' + user.uid +'/'+ datestring+ '/score/bareminimumpercentage/');\r\n  set(reference1, {\r\n    percentage: percentage,\r\n  });\r\n}\r\n\r\nfunction toggleTaskCompleted(id) {\r\n  const updatedTasks = tasks.map(task => {\r\n    // if this task has the same ID as the edited task\r\n    if (id === task.id) {\r\n      // use object spread to make a new obkect\r\n      // whose `completed` prop has been inverted\r\n      const db = getDatabase();\r\n      var user = firebaseConfig.auth().currentUser\r\n      var d = new Date();\r\n      var datestring = d.getDate()  + \"-\" + (d.getMonth()+1) + \"-\" + d.getFullYear();\r\n      const reference = ref(db, 'users/' + user.uid +'/'+ datestring+ '/bareminimum/' + id);\r\n      set(reference, {\r\n        todoid: task.id,\r\n        name : task.name,\r\n        completed : !task.completed\r\n      });\r\n      return {...task, completed: !task.completed}\r\n    }\r\n    return task;\r\n  });\r\n  //setTasks(updatedTasks);\r\n  fetchDataFromFirebase();\r\n  CalculatePersonalScore();\r\n}\r\n\r\n\r\nfunction deleteTask(id) {\r\n  const remainingTasks = tasks.filter(task => id !== task.id);\r\n  //setTasks(remainingTasks);\r\n  const db = getDatabase();\r\n  var user = firebaseConfig.auth().currentUser\r\n  var d = new Date();\r\n  var datestring = d.getDate()  + \"-\" + (d.getMonth()+1) + \"-\" + d.getFullYear();\r\n  const reference = ref(db, 'users/' + user.uid +'/'+ datestring+ '/bareminimum/'+ id);\r\n  set(reference, {\r\n    id: null\r\n  });\r\n  fetchDataFromFirebase();\r\n}\r\n\r\n\r\nfunction editTask(id, newName) {\r\n  const editedTaskList = tasks.map(task => {\r\n  // if this task has the same ID as the edited task\r\n    if (id === task.id) {\r\n      //\r\n      const db = getDatabase();\r\n      var user = firebaseConfig.auth().currentUser\r\n      var d = new Date();\r\n      var datestring = d.getDate()  + \"-\" + (d.getMonth()+1) + \"-\" + d.getFullYear();\r\n      const reference = ref(db, 'users/' + user.uid +'/'+ datestring+ '/bareminimum/'+ task.id);\r\n      set(reference, {\r\n        todoid: task.id,\r\n        name : newName,\r\n        completed : task.completed\r\n      });\r\n      return {...task, name: newName}\r\n    }\r\n    return task;\r\n  });\r\n  //setTasks(editedTaskList);\r\n  fetchDataFromFirebase();\r\n}\r\n\r\nconst taskList = tasks\r\n.filter(FILTER_MAP[filter])\r\n.map(task => (\r\n  <Todo\r\n    id={task.id}\r\n    name={task.name}\r\n    completed={task.completed}\r\n    key={task.id}\r\n    toggleTaskCompleted={toggleTaskCompleted}\r\n    deleteTask={deleteTask}\r\n    editTask={editTask}\r\n  />\r\n));\r\n\r\nconst filterList = FILTER_NAMES.map(name => (\r\n  <FilterButton\r\n    key={name}\r\n    name={name}\r\n    isPressed={name === filter}\r\n    setFilter={setFilter}\r\n  />\r\n));\r\n\r\n\r\nfunction addTask(name) {\r\n  const newTask = { id: \"todo-\" + nanoid(), name: name, completed: false };\r\n  //setTasks([...tasks, newTask]);\r\n    //Database related\r\n    const db = getDatabase();\r\n    var user = firebaseConfig.auth().currentUser\r\n    var d = new Date();\r\n    var datestring = d.getDate()  + \"-\" + (d.getMonth()+1) + \"-\" + d.getFullYear();\r\n    const reference = ref(db, 'users/' + user.uid +'/'+ datestring+ '/bareminimum/'+ newTask.id);\r\n    set(reference, {\r\n      todoid: newTask.id,\r\n      name : newTask.name,\r\n      completed : newTask.completed\r\n    });\r\n    fetchDataFromFirebase();\r\n}\r\n\r\n\r\nconst tasksNoun = taskList.length !== 1 ? 'tasks' : 'task';\r\nconst headingText = `${taskList.length} ${tasksNoun} remaining`;\r\n\r\nconst listHeadingRef = useRef(null);\r\nconst prevTaskLength = usePrevious(tasks.length);\r\n\r\nuseEffect(() => {\r\n  fetchDataFromFirebase();\r\n  CalculatePersonalScore();\r\n  if (tasks.length - prevTaskLength === -1) {\r\n    listHeadingRef.current.focus();\r\n  }\r\n}, [tasks.length, prevTaskLength]);\r\n\r\nconst { currentUser } = useContext(AuthContext);\r\nif (!currentUser) {\r\n  return <Redirect to=\"/\" />;\r\n}\r\n\r\nlet Progress = (props) => {\r\n  return (\r\n    <div className=\"Progress\" data-value={props.value}>\r\n      <div\r\n        className=\"Progress-Bar\"\r\n        style={{\r\n          width: `${props.value}%`,\r\n          backgroundSize: `${100 * 100 / props.value}% 100%`\r\n        }}        \r\n      ></div>\r\n    </div>\r\n  );\r\n};\r\n\r\nreturn (\r\n    <div>\r\n      <div className=\"todoapp stack-large\">\r\n        <h1>Bare Minimum</h1>\r\n        <Progress value={count} />\r\n      <Form addTask={addTask} />\r\n      <div className=\"filters btn-group stack-exception\">\r\n        {filterList}\r\n      </div>\r\n      <h2 id=\"list-heading\" tabIndex=\"-1\" ref={listHeadingRef}>\r\n        {headingText}\r\n      </h2>\r\n      <ul\r\n        role=\"list\"\r\n        className=\"todo-list stack-large stack-exception\"\r\n        aria-labelledby=\"list-heading\"\r\n      >\r\n        {taskList}\r\n      </ul>\r\n    </div>\r\n  </div>\r\n  );\r\n}\r\n\r\nexport default Bareminimum;\r\n\r\n\r\n"]},"metadata":{},"sourceType":"module"}